#admin-article
  = form_for @newsletter, url: newsletter_path(@newsletter) do |f|
    - if @newsletter.errors.any?
      #error_explanation
        %h2= "#{pluralize(@newsletter.errors.count, "error")} prohibited this article from being saved:"
        %ul
          - @newsletter.errors.full_messages.each do |msg|
            %li= msg
    %fieldset{class: "inputs"}
      %legend
        %span
          = f.label :name, @newsletter.name
      .field
        %ul.accordion{"data-accordion" => ""}
          - ar_with_categories = @newsletter.eligible_articles_by_category
          - ar_with_categories.each do |category_name, articles|
            %li.accordion-navigation
              %a{href: "##{category_name.parameterize.underscore}"}
                = category_name
              %div{id: category_name.parameterize.underscore, class: "content"}
                - articles.each do |article|
                  .article{class: "#{'chosen' if article.newsletter_id == @newsletter.id}"}
                    .article-overlay
                    = check_box_tag("newsletter[article_ids][]", article.id, @newsletter.articles.include?(article), class: "hide")
                    .title
                      = link_to article.title, article_path(article.id)
                    = image_tag(article.cover_image.url)
    .actions
      = f.submit 'Save'